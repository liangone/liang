{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{571:function(t,s,a){\"use strict\";a.r(s);var n=a(12),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[s(\"h1\",{attrs:{id:\"_29-跨域是什么-vue项目中你是如何解决跨域的呢\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_29-跨域是什么-vue项目中你是如何解决跨域的呢\"}},[t._v(\"#\")]),t._v(\" 29.跨域是什么？Vue项目中你是如何解决跨域的呢？\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/IceRain-mvc/cdn/img/640-20210928225507414\",alt:\"图片\"}})]),t._v(\" \"),s(\"h2\",{attrs:{id:\"一、跨域是什么\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#一、跨域是什么\"}},[t._v(\"#\")]),t._v(\" 一、跨域是什么\")]),t._v(\" \"),s(\"p\",[t._v(\"跨域本质是浏览器基于\"),s(\"strong\",[t._v(\"同源策略\")]),t._v(\"的一种安全手段\")]),t._v(\" \"),s(\"p\",[t._v(\"同源策略（Sameoriginpolicy），是一种约定，它是浏览器最核心也最基本的安全功能\")]),t._v(\" \"),s(\"p\",[t._v(\"所谓同源（即指在同一个域）具有以下三个相同点\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"协议相同（protocol）\")]),t._v(\" \"),s(\"li\",[t._v(\"主机相同（host）\")]),t._v(\" \"),s(\"li\",[t._v(\"端口相同（port）\")])]),t._v(\" \"),s(\"p\",[t._v(\"反之非同源请求，也就是协议、端口、主机其中一项不相同的时候，这时候就会产生跨域\")]),t._v(\" \"),s(\"blockquote\",[s(\"p\",[t._v(\"一定要注意跨域是浏览器的限制，你用抓包工具抓取接口数据，是可以看到接口已经把数据返回回来了，只是浏览器的限制，你获取不到数据。用postman请求接口能够请求到数据。这些再次印证了跨域是浏览器的限制。\")])]),t._v(\" \"),s(\"h2\",{attrs:{id:\"二、如何解决\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#二、如何解决\"}},[t._v(\"#\")]),t._v(\" 二、如何解决\")]),t._v(\" \"),s(\"p\",[t._v(\"解决跨域的方法有很多，下面列举了三种：\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"JSONP\")]),t._v(\" \"),s(\"li\",[t._v(\"CORS\")]),t._v(\" \"),s(\"li\",[t._v(\"Proxy\")])]),t._v(\" \"),s(\"p\",[t._v(\"而在\"),s(\"code\",[t._v(\"vue\")]),t._v(\"项目中，我们主要针对\"),s(\"code\",[t._v(\"CORS\")]),t._v(\"或\"),s(\"code\",[t._v(\"Proxy\")]),t._v(\"这两种方案进行展开\")]),t._v(\" \"),s(\"h3\",{attrs:{id:\"cors\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#cors\"}},[t._v(\"#\")]),t._v(\" CORS\")]),t._v(\" \"),s(\"p\",[t._v(\"CORS （Cross-Origin Resource Sharing，跨域资源共享）是一个系统，它由一系列传输的HTTP头组成，这些HTTP头决定浏览器是否阻止前端 JavaScript 代码获取跨域请求的响应\")]),t._v(\" \"),s(\"p\",[s(\"code\",[t._v(\"CORS\")]),t._v(\" 实现起来非常方便，只需要增加一些 \"),s(\"code\",[t._v(\"HTTP\")]),t._v(\" 头，让服务器能声明允许的访问来源\")]),t._v(\" \"),s(\"p\",[t._v(\"只要后端实现了 \"),s(\"code\",[t._v(\"CORS\")]),t._v(\"，就实现了跨域\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\",alt:\"图片\"}})]),t._v(\" \"),s(\"p\",[t._v(\"以\"),s(\"code\",[t._v(\"koa\")]),t._v(\"框架举例\")]),t._v(\" \"),s(\"p\",[t._v(\"添加中间件，直接设置\"),s(\"code\",[t._v(\"Access-Control-Allow-Origin\")]),t._v(\"请求头\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-js extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[s(\"code\",[t._v(\"app\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"use\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"async\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token parameter\"}},[t._v(\"ctx\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=>\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  ctx\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"set\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'Access-Control-Allow-Origin'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'*'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n  ctx\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"set\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'Access-Control-Allow-Headers'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'Content-Type, Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n  ctx\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"set\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'Access-Control-Allow-Methods'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'PUT, POST, GET, DELETE, OPTIONS'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"ctx\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"method \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"==\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'OPTIONS'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    ctx\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"body \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"200\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"await\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"next\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n  \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\")])])]),s(\"p\",[t._v(\"ps: \"),s(\"code\",[t._v(\"Access-Control-Allow-Origin\")]),t._v(\" 设置为*其实意义不大，可以说是形同虚设，实际应用中，上线前我们会将\"),s(\"code\",[t._v(\"Access-Control-Allow-Origin\")]),t._v(\" 值设为我们目标\"),s(\"code\",[t._v(\"host\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"proxy\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#proxy\"}},[t._v(\"#\")]),t._v(\" Proxy\")]),t._v(\" \"),s(\"p\",[t._v(\"代理（Proxy）也称网络代理，是一种特殊的网络服务，允许一个（一般为客户端）通过这个服务与另一个网络终端（一般为服务器）进行非直接的连接。一些网关、路由器等网络设备具备网络代理功能。一般认为代理服务有利于保障网络终端的隐私或安全，防止攻击\")]),t._v(\" \"),s(\"p\",[s(\"strong\",[t._v(\"方案一\")])]),t._v(\" \"),s(\"p\",[t._v(\"如果是通过\"),s(\"code\",[t._v(\"vue-cli\")]),t._v(\"脚手架工具搭建项目，我们可以通过\"),s(\"code\",[t._v(\"webpack\")]),t._v(\"为我们起一个本地服务器作为请求的代理对象\")]),t._v(\" \"),s(\"p\",[t._v(\"通过该服务器转发请求至目标服务器，得到结果再转发给前端，但是最终发布上线时如果web应用和接口服务器不在一起仍会跨域\")]),t._v(\" \"),s(\"p\",[t._v(\"在\"),s(\"code\",[t._v(\"vue.config.js\")]),t._v(\"文件，新增以下代码\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-js extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[s(\"code\",[t._v(\"amodule\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"exports \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"devServer\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"host\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'127.0.0.1'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"port\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"8084\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"open\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[t._v(\"true\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// vue项目启动时自动打开浏览器\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"proxy\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[t._v(\"'/api'\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// '/api'是代理标识，用于告诉node，url前面是/api的就是使用代理的\")]),t._v(\"\\n                \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"target\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"http://xxx.xxx.xx.xx:8080\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//目标地址，一般是指后台服务器地址\")]),t._v(\"\\n                \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"changeOrigin\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[t._v(\"true\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//是否跨域\")]),t._v(\"\\n                \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"pathRewrite\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// pathRewrite 的作用是把实际Request Url中的'/api'用\\\"\\\"代替\")]),t._v(\"\\n                    \"),s(\"span\",{pre:!0,attrs:{class:\"token string-property property\"}},[t._v(\"'^/api'\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"\"')]),t._v(\" \\n                \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n            \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),s(\"p\",[t._v(\"通过\"),s(\"code\",[t._v(\"axios\")]),t._v(\"发送请求中，配置请求的根路径\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-js extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[s(\"code\",[t._v(\"axios\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"defaults\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"baseURL \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'/api'\")]),t._v(\"\\n\")])])]),s(\"p\",[s(\"strong\",[t._v(\"方案二\")])]),t._v(\" \"),s(\"p\",[t._v(\"此外，还可通过服务端实现代理请求转发\")]),t._v(\" \"),s(\"p\",[t._v(\"以\"),s(\"code\",[t._v(\"express\")]),t._v(\"框架为例\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-js extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),t._v(\" express \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"require\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'express'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" proxy \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"require\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'http-proxy-middleware'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" app \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"express\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\napp\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"use\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"express\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"static\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"__dirname \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'/'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\napp\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"use\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'/api'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"proxy\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"target\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'http://localhost:4000'\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token literal-property property\"}},[t._v(\"changeOrigin\")]),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[t._v(\"false\")]),t._v(\"\\n                      \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\nmodule\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"exports \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" app\\n\")])])]),s(\"p\",[s(\"strong\",[t._v(\"方案三\")])]),t._v(\" \"),s(\"p\",[t._v(\"通过配置\"),s(\"code\",[t._v(\"nginx\")]),t._v(\"实现代理\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-nginx extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-nginx\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"server\")])]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"listen\")]),t._v(\"    \"),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"80\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# server_name xxx.xxx.com;\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"location\")]),t._v(\" /\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"root\")]),t._v(\"  /var/www/html\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"index\")]),t._v(\"  index.html index.htm\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"try_files\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$uri\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$uri\")]),t._v(\"/ /index.html\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"location\")]),t._v(\" /api\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"proxy_pass\")]),t._v(\"  http://127.0.0.1:3000\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"proxy_redirect\")]),t._v(\"   \"),s(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[t._v(\"off\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"proxy_set_header\")]),t._v(\"  Host       \"),s(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$host\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"proxy_set_header\")]),t._v(\"  X-Real-IP     \"),s(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$remote_addr\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),s(\"span\",{pre:!0,attrs:{class:\"token directive\"}},[s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"proxy_set_header\")]),t._v(\"  X-Forwarded-For  \"),s(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$proxy_add_x_forwarded_for\")])]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);","extractedComments":[]}